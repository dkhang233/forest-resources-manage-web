"use strict";(self["webpackChunkforest_resources_manage_application"]=self["webpackChunkforest_resources_manage_application"]||[]).push([[488],{2012:function(e,t,l){l.d(t,{bC:function(){return o},sE:function(){return n}});var a=l(7877);const o=e=>a.x1.get(`administrations/${e}/sub`),n=(e,t)=>a.x1.post(`administrations/${e}`,t)},2488:function(e,t,l){l.r(t),l.d(t,{default:function(){return _}});var a=l(3396),o=l(7139);const n=e=>((0,a.dD)("data-v-4d930722"),e=e(),(0,a.Cn)(),e),r={class:"tree"},i={class:"custom-tree-node"},s=["onClick"],d=n((()=>(0,a._)("div",{class:"card-header"},[(0,a._)("span",null,"Map")],-1))),u=n((()=>(0,a._)("map",null,null,-1))),h={class:"grid grid-cols-6 gap-4"};function m(e,t,l,n,m,c){const p=(0,a.up)("font-awesome-icon"),f=(0,a.up)("el-input"),g=(0,a.up)("el-tree-v2"),b=(0,a.up)("el-card"),v=(0,a.up)("el-col"),w=(0,a.up)("Map"),_=(0,a.up)("el-row"),x=(0,a.up)("el-form-item"),V=(0,a.up)("el-option"),y=(0,a.up)("el-select"),C=(0,a.up)("el-form"),W=(0,a.up)("el-dialog"),T=(0,a.Q2)("loading");return(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",r,[(0,a.Wm)(_,{gutter:50},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{span:10},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{class:"administrations"},{header:(0,a.w5)((()=>[(0,a.Wm)(p,{icon:["fas","magnifying-glass"],flip:"horizontal",size:"lg"}),(0,a.Wm)(f,{offset:2,modelValue:m.filterText,"onUpdate:modelValue":t[0]||(t[0]=e=>m.filterText=e),placeholder:"Tìm kiếm đơn vị hành chính theo tên hoặc mã",class:"form"},null,8,["modelValue"])])),default:(0,a.w5)((()=>[(0,a.Wm)(g,{"default-expand-all":"",ref:"treeRef",class:"el-tree",data:m.treeData,props:m.defaultProps,"item-size":50,"expand-on-click-node":!1,"filter-method":c.filterNode,height:500},{default:(0,a.w5)((({node:e,data:t})=>[(0,a._)("span",i,[(0,a._)("span",null,(0,o.zw)(`${e.label} (${t.code})`),1),(0,a._)("a",{class:"text-blue-500 ml-[100px] hover:text-blue-300",onClick:e=>c.showNode(t)},"Chi tiết",8,s)])])),_:1},8,["data","props","filter-method"])])),_:1})])),_:1}),(0,a.Wm)(v,{span:13},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{class:"box-card"},{header:(0,a.w5)((()=>[d])),default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"h-[31rem]"})])),_:1})])),_:1})])),_:1}),u,(0,a.Wm)(W,{modelValue:m.dialogFormVisible,"onUpdate:modelValue":t[8]||(t[8]=e=>m.dialogFormVisible=e),title:"Thông tin đơn vị hành chính"},{footer:(0,a.w5)((()=>[(0,a._)("span",h,[(0,a._)("button",{class:"p-2 mr-5 space-x-[100px] font-sans font-bold text-white rounded-lg shadow-lg px-5 bg-red-500 shadow-blue-100 hover:bg-opacity-90 hover:shadow-lg border transition hover:-translate-y-0.5 duration-150",onClick:t[5]||(t[5]=(...e)=>c.deleteBtn&&c.deleteBtn(...e))}," Xóa "),(0,a._)("button",{class:"p-2 mr-3 col-start-5 font-sans font-bold text-white rounded-lg shadow-lg px-5 bg-[#839192] shadow-blue-100 hover:bg-opacity-90 hover:shadow-lg border transition hover:-translate-y-0.5 duration-150",onClick:t[6]||(t[6]=e=>m.dialogFormVisible=!1)}," Quay lại "),(0,a._)("button",{class:"p-2 col-start-6 font-sans font-bold text-white rounded-lg shadow-lg px-5 bg-blue-500 shadow-blue-100 hover:bg-opacity-90 hover:shadow-lg border transition hover:-translate-y-0.5 duration-150",onClick:t[7]||(t[7]=e=>c.updateBtn(this.$refs.ruleFormRef))}," Cập nhập ")])])),default:(0,a.w5)((()=>[(0,a.Wm)(C,{ref:"ruleFormRef",model:m.form,"status-icon":"",rules:m.rules},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"Mã",prop:"code"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{modelValue:m.form.code,"onUpdate:modelValue":t[1]||(t[1]=e=>m.form.code=e),autocomplete:"off",disabled:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(x,{label:"Cấp Hành Chính",prop:"level"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{modelValue:m.form.level,"onUpdate:modelValue":t[2]||(t[2]=e=>m.form.level=e),placeholder:"Chọn cấp hành chính"},{default:(0,a.w5)((()=>[(0,a.Wm)(V,{label:"xã",value:"xã"}),(0,a.Wm)(V,{label:"thị trấn",value:"thị trấn"}),(0,a.Wm)(V,{label:"huyện",value:"huyện"}),(0,a.Wm)(V,{label:"thành phố",value:"thành phố"}),(0,a.Wm)(V,{label:"tỉnh",value:"tỉnh"})])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(x,{label:"Tên",prop:"name"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{modelValue:m.form.name,"onUpdate:modelValue":t[3]||(t[3]=e=>m.form.name=e),placeholder:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(x,{label:"Trực thuộc",prop:"sub"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{modelValue:m.form.subCode,"onUpdate:modelValue":t[4]||(t[4]=e=>m.form.subCode=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])),[[T,m.loadingStatus]])}var c=l(2012),p=l(1020),f=l(7322),g=l(8451),b={components:{Map:g.Z},data(){return{defaultProps:{value:"code",children:"children",label:"fullName"},filterText:"",treeData:[],dialogFormVisible:!1,form:{code:"",level:"",name:"",subCode:""},rules:{name:[{validator:this.checkAdministrationName,trigger:"change"},{validator:this.checkAdministrationSub,trigger:"change"}]},loadingStatus:!1}},watch:{filterText(e){this.$refs.treeRef.filter(e)}},computed:{...(0,p.Kc)(f.L)},methods:{filterNode(e,t){return console.log(t),!e||(t.fullName.includes(e)||t.code.includes(e))},showNode(e){this.form.code=e.code,this.form.name=e.name,this.form.level=e.levelName,this.form.subCode=e.subordinateCode,this.dialogFormVisible=!0},checkAdministrationName(e,t,l){if(!t)return l(new Error("Vui lòng nhập mã hành chính"));l()},checkAdministrationSub(e,t,l){if(!t)return l(new Error("Vui lòng trực thuộc"));l()},updateBtn(e){e&&e.validate((e=>{if(!e)return console.log("error submit!"),!1;this.$confirm("Cập nhập đơn vị hành chính này. Tiếp tục?","Xác nhận",{confirmButtonText:"OK",cancelButtonText:"Hủy",type:"warning"}).then((()=>{this.updateAdministration(),this.dialogFormVisible=!1})).catch((()=>{}))}))},deleteBtn(){this.$confirm("Xóa đơn vị hành chính này. Tiếp tục?","Cảnh báo",{confirmButtonText:"OK",cancelButtonText:"Hủy",type:"warning"}).then((()=>{this.dialogFormVisible=!1,this.$notify({title:"Thành công",message:"Xóa thành công",type:"success"})})).catch((()=>{}))},retrieveAdministrations(){this.loadingStatus=!0,(0,c.bC)(35).then((e=>{this.treeData=e.data,this.loadingStatus=!1})).catch((e=>console.log(e)))},updateAdministration(){this.loadingStatus=!0,(0,c.sE)(this.form.code,{name:this.form.name,subordinateCode:this.form.subCode,administrativeLevelName:this.form.level}).then((e=>{this.loadingStatus=!1,this.$notify({title:"Thành công",message:"Cập nhập thành công",type:"success"}),this.retrieveAdministrations()})).catch((e=>{this.loadingStatus=!1;let t="";try{t=e.response.data.messages,this.$notify({title:"Đã xảy ra lỗi",message:t,type:"error"})}catch(l){}console.log(e)}))}},created(){this.retrieveAdministrations()}},v=l(89);const w=(0,v.Z)(b,[["render",m],["__scopeId","data-v-4d930722"]]);var _=w}}]);
//# sourceMappingURL=488.f435141f.js.map